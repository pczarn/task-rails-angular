<%= File.read(Rails.root.join('app/assets/javascripts/templates/_add_order.html')) %>

<div class="panel-group">
  <div ng-repeat="order in orders | filter: category | orderBy: '-created_at' track by order.id" class="panel panel-default">
    <header class="panel-heading clearfix">
      <%= File.read(Rails.root.join('app/assets/javascripts/templates/_order_title.html')) %>
      <!-- button for finalizing in tab 0 -->
      <div class="btn-toolbar pull-right" role="toolbar">
        <button ng-click="setStatus(order,statuses['finalized'])" ng-disabled="order.meals.length==0" class="btn btn-default">
          Finalize
        </button>
      </div>
    </header>

    <div ng-class="{in:order.show}" class="panel-collapse collapse">
      <div class="panel-body">
        <!-- repeated meals in model -->
        <%= File.read(Rails.root.join('app/assets/javascripts/templates/_repeat_meals.html')) %>
        <!-- horizontal meal input group -->
        <div class="list-group-item">
          <form ng-submit="addMeal(order)" class="form-horizontal" role="form">
            <div ng-class="{error:order.error}" class="form-group container no-margin-b">
              <div class="input-group col-sm-6">
                <span class="input-group-addon">Meal name</span>
                <input type="text" ng-model="order.newMeal.name" required class="form-control">
                <span class="input-group-addon">Price</span>
                <!-- price input with constraints. -->
                <!-- minimal price is 0 in case someone wants to take a free thing. -->
                <input type="number" ng-model="order.newMeal.price" step="0.01" min="0" required class="form-control input-short">
                <span class="input-group-addon">z≈Ç</span>
                <span class="input-group-btn">
                  <button type="submit" class="btn btn-default">Add meal</button>
                </span>
              </div>
              <span ng-show="order.error" class="alert alert-danger alert-overlay">You already added a meal!</span>
            </div>
          </form>
        </div>
      </div>
    </div>
  </div>
</div>
